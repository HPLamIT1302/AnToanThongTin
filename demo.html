<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estimating Password Cracking Time</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Estimating Password Cracking Time</h1>
        <div class="row justify-content-center mt-3">
            <div class="col-md-6">
                <input type="password" id="passwordInput" class="form-control mb-2" placeholder="Nhập mật khẩu để kiểm tra">
                <button class="btn btn-primary btn-block" onclick="estimateCrackTime()">Kiểm tra thời gian dò lại mật khẩu</button>
                <div id="crackTimeResult" class="mt-3"></div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="./js/dictonary.js"></script>
    <script src="./js/wordlist.js"></script>
    <script >
        // Mảng chứa danh sách từ điển và mật khẩu phổ biến
// const dictionary = ["password", "123456", "qwerty", "football", "welcome", "admin", "login", "abc123"];
// const wordlist = ["apple", "orange", "banana", "password", "123456", "qwerty", "football", "welcome"];

function estimateCrackTime() {
    const password = document.getElementById('passwordInput').value;
    const isWeak = isInDictionary(password) || isCommonPassword(password);

    let crackTimeSeconds;
    if (isWeak) {
        crackTimeSeconds = 0; // Nếu mật khẩu yếu, giả sử thời gian dò lại là 0 giây
    } else {
        crackTimeSeconds = calculateCrackTime(password);
    }

    const formattedTime = formatTime(crackTimeSeconds);

    const crackTimeResultElement = document.getElementById('crackTimeResult');
    crackTimeResultElement.innerHTML = `
        <div class="alert alert-info mt-3" role="alert">
            Thời gian ước tính để dò lại mật khẩu: ${formattedTime}
        </div>
    `;
}

function calculateCrackTime(password) {
    const characters = 94; // Số lượng ký tự có thể sử dụng (khoảng 94 ký tự ASCII có thể in được)
    const keysPerSecond = 17042497.3; // Số lượng phím mỗi giây

    const possibilities = characters ** password.length; // Số lượng khả năng mật khẩu
    const crackTimeSeconds = possibilities / keysPerSecond; // Thời gian ước tính để dò lại mật khẩu (giây)

    return crackTimeSeconds;
}

function formatTime(seconds) {
    if (seconds < 1) {
        return "dưới 1 giây";
    }

    const timeUnits = [
        { unit: "năm", duration: 60 * 60 * 24 * 365 },
        { unit: "tháng", duration: 60 * 60 * 24 * 30 },
        { unit: "ngày", duration: 60 * 60 * 24 },
        { unit: "giờ", duration: 60 * 60 },
        { unit: "phút", duration: 60 },
        { unit: "giây", duration: 1 }
    ];

    for (const unit of timeUnits) {
        const value = Math.floor(seconds / unit.duration);
        if (value >= 1) {
            return `${value} ${unit.unit}${value === 1 ? "" : "s"}`;
        }
    }

    return "một vài giây"; // Trường hợp dưới 1 giây
}

function isInDictionary(password) {
    const lowercasePassword = password.toLowerCase();
    return dictionary.includes(lowercasePassword);
}

function isCommonPassword(password) {
    const lowercasePassword = password.toLowerCase();
    return wordlist.includes(lowercasePassword);
}

    </script>
</body>
</html>
